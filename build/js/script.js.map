{"version":3,"file":"script.js","names":["window","addEventListener","document","querySelector","body","classList","add","navLinks","querySelectorAll","mob_navLinks","headerBottom","headerLogo","header__top","burger_logo","applyScrolledClasses","forEach","el","path","removeScrolledClasses","remove","contains","moveThreshold","styleThreshold","scrollY","card","badge","createElement","className","textContent","appendChild","swiperInstance","initBlogSwiper","screenWidth","innerWidth","Swiper","slidesPerView","spaceBetween","slidesOffsetBefore","slidesOffsetAfter","destroy","wrapper","slides","removeAttribute","slide","navItems","submenu","getElementById","submenuContents","logo","item","target","dataset","menu","style","overflow","nav","link","content","toggle","pathEl","parentElement","$","ready","select2","minimumResultsForSearch","width","button","updateWidth","buttonWidth","offsetWidth","select2Container","observer","ResizeObserver","observe","burger","mobileMenu","closeMenu","overlay","openMenu","closeMenuFunc","currentLi","closest","activeMenu","maxHeight","activeToggle","scrollHeight","setTimeout","material","title","arrow","h2","toggleMenu","e","preventDefault","priceBlocks","block","sliderEl","noUiSlider","rangeMin","parseInt","rangeMax","urlParams","URLSearchParams","location","search","minParam","maxParam","startMin","get","startMax","lowerEl","upperEl","create","start","connect","range","min","max","step","currentMin","String","currentMax","on","values","minVal","Math","round","maxVal","filters","itemsBlock","stickyOffset","stopOffset","hysteresis","isStuck","isAtBottom","lastScrollY","currentScrollY","deltaY","abs","containerTop","getBoundingClientRect","top","itemsBottom","bottom","filtersHeight","offsetHeight","position","filterWrapper","openBtn","closeBtn","updateProducts","url","currentGrid","cards","fetch","then","res","text","html","parser","DOMParser","doc","parseFromString","newGrid","innerHTML","newCards","opacity","transform","transition","history","pushState","attachPaginationListeners","a","href","tabs","contents","tab","t","c","cartForms","form","variantSelect","priceEl","optionWrappers","buttons","selectEl","length","btn","value","dispatchEvent","Event","updateVariant","selectedOptions","index","optionIndex","activeBtn","firstOption","matchedVariant","Array","from","options","find","option","variantOptions","JSON","parse","every","opt","i","price","productContainer","mainImage","mainLink","image","src","newUrl","pathname","replaceState","product","qtyControl","qtyValue","qtyInput","minusBtn","plusBtn","current","setupCartQtyButtons","qtyButtons","key","action","qtyEl","currentQty","newQty","formData","FormData","append","method","cart","json","renderCart","productForms","cartSidebar","cartOverlay","productForm","cartSidebarItems","cartPageItems","items","featured_image","product_title","final_line_price","toFixed","currency","options_with_values","map","name","join","quantity","insertAdjacentHTML","subtotalEls","total_price","cartCounter","cartCounterheader","item_count","setupRemoveButtons","onclick","updateCartQuantity","removeButtons","headers","stringify","id","clearBtn","updateCartUI","cartCounterHeader","popupCartItems","subtotal","pageCartItems","row","checkoutContainer","checkoutBtn","buyNowBtn","productDetails","addToCartForm","variantId","qty","alert","cartBtn","cartImg","cartImgMob","cartClose","openCart","closeCartFunc"],"sources":["script.js"],"sourcesContent":["////////////////////////////scroll////////////////////\r\nwindow.addEventListener( 'DOMContentLoaded', function () {\r\n\t// Якщо на сторінці є секція catalog_main — додаємо клас\r\n\tif (document.querySelector( '.catalog_main, .product_page, .cart_main ' )) {\r\n\t\tdocument.body.classList.add( 'white_header' );\r\n\t}\r\n\r\n\tconst navLinks = document.querySelectorAll( '.header_nav .nav__list li > a' );\r\n\tconst mob_navLinks = document.querySelectorAll( '.header_nav .mobile_nav_list > a' );\r\n\tconst headerBottom = document.querySelector( '.header__bottom' );\r\n\tconst headerLogo = document.querySelector( '.header_logo' );\r\n\tconst header__top = document.querySelector( '.header__top' );\r\n\tconst burger_logo = document.querySelectorAll( '.burger-menu .bar' );\r\n\r\n\tconst applyScrolledClasses = () => {\r\n\t\tnavLinks.forEach( el => el.classList.add( 'scrolled' ) );\r\n\t\tmob_navLinks.forEach( el => el.classList.add( 'scrolled' ) );\r\n\t\tburger_logo.forEach( el => el.classList.add( 'scrolled' ) );\r\n\t\theaderLogo?.classList.add( 'scrolled' );\r\n\r\n\t\theaderBottom?.classList.add( 'scrolled' );\r\n\r\n\t\t// Додаємо клас для svg path в активних submenu-toggle\r\n\t\tdocument.querySelectorAll( '.header .header_left .header_nav .nav__list .submenu-toggle svg path' ).forEach( path => {\r\n\t\t\tpath.classList.add( 'active' );\r\n\t\t} );\r\n\t};\r\n\r\n\tconst removeScrolledClasses = () => {\r\n\t\tnavLinks.forEach( el => el.classList.remove( 'scrolled' ) );\r\n\t\tmob_navLinks.forEach( el => el.classList.remove( 'scrolled' ) );\r\n\t\tburger_logo.forEach( el => el.classList.remove( 'scrolled' ) );\r\n\t\theaderLogo?.classList.remove( 'scrolled' );\r\n\r\n\t\theaderBottom?.classList.remove( 'scrolled' );\r\n\r\n\t\t// Знімаємо клас для svg path в активних submenu-toggle\r\n\t\tdocument.querySelectorAll( '.header .header_left .header_nav .nav__list .submenu-toggle svg path' ).forEach( path => {\r\n\t\t\tpath.classList.remove( 'active' );\r\n\t\t} );\r\n\r\n\t};\r\n\r\n\tif (document.body.classList.contains( 'white_header' )) {\r\n\t\t// Каталог — одразу білий хедер\r\n\t\theaderBottom?.classList.add( 'scrolled_top' );\r\n\r\n\t\tapplyScrolledClasses();\r\n\t} else {\r\n\t\t// Головна — тільки при скролі\r\n\t\twindow.addEventListener( 'scroll', function () {\r\n\t\t\tconst moveThreshold = 48;\r\n\t\t\tconst styleThreshold = 450;\r\n\r\n\t\t\tif (window.scrollY > moveThreshold) {\r\n\t\t\t\theaderBottom?.classList.add( 'scrolled_top' );\r\n\t\t\t\theader__top?.classList.add( 'slide-up' );\r\n\t\t\t} else {\r\n\t\t\t\theaderBottom?.classList.remove( 'scrolled_top' );\r\n\t\t\t\theader__top?.classList.remove( 'slide-up' );\r\n\t\t\t}\r\n\r\n\t\t\tif (window.scrollY > styleThreshold) {\r\n\t\t\t\tapplyScrolledClasses();\r\n\t\t\t} else {\r\n\t\t\t\tremoveScrolledClasses();\r\n\t\t\t}\r\n\t\t} );\r\n\t}\r\n} );\r\n\r\n\r\n/////////////////////////badge_items_card/////////////////////////////////\r\ndocument.querySelectorAll( '[data-badge=\"new\"]' ).forEach( card => {\r\n\tconst badge = document.createElement( 'span' );\r\n\tbadge.className = 'product-badge';\r\n\tbadge.textContent = 'New';\r\n\tcard.querySelector( '.card_image' ).appendChild( badge );\r\n} );\r\n\r\n///////////////////////////////swiper///////////////////////////\r\nlet swiperInstance = null;\r\n\r\nfunction initBlogSwiper() {\r\n\tconst screenWidth = window.innerWidth;\r\n\r\n\tif (screenWidth < 1580 && !swiperInstance) {\r\n\t\t// Ініціалізація Swiper\r\n\t\tswiperInstance = new Swiper( '.blog__posts.swiper', {\r\n\t\t\tslidesPerView: 'auto',\r\n\t\t\tspaceBetween: 10,\r\n\t\t\tslidesOffsetBefore: 15,\r\n\t\t\tslidesOffsetAfter: 15\r\n\t\t} );\r\n\t} else if (screenWidth >= 1580 && swiperInstance) {\r\n\t\t// Видаляємо Swiper\r\n\t\tswiperInstance.destroy( true, true );\r\n\t\tswiperInstance = null;\r\n\r\n\t\t// ✅ Відновлюємо початкові стилі\r\n\t\tconst wrapper = document.querySelector( '.blog__posts .swiper-wrapper' );\r\n\t\tconst slides = document.querySelectorAll( '.blog__posts .swiper-slide' );\r\n\r\n\t\tif (wrapper) {\r\n\t\t\twrapper.removeAttribute( 'style' );\r\n\t\t\twrapper.classList.remove( 'swiper-wrapper' ); // не обов'язково, але можна\r\n\t\t}\r\n\r\n\t\tslides.forEach( slide => {\r\n\t\t\tslide.removeAttribute( 'style' );\r\n\t\t\tslide.classList.remove( 'swiper-slide' ); // не обов'язково, але можна\r\n\t\t} );\r\n\t}\r\n}\r\n\r\nwindow.addEventListener( 'load', initBlogSwiper );\r\nwindow.addEventListener( 'resize', initBlogSwiper );\r\n\r\n\r\n//////////////////////////header_menu//////////////////////////\r\nconst navItems = document.querySelectorAll( '.nav-item' );\r\nconst submenu = document.getElementById( 'submenu' );\r\nconst submenuContents = submenu.querySelectorAll( '.submenu-content' );\r\nconst headerBottom = document.querySelector( '.header__bottom' );\r\nconst logo = document.querySelector( '.header_logo' );\r\nconst navLinks = document.querySelectorAll( '.nav_link' );\r\n\r\nnavItems.forEach( item => {\r\n\titem.addEventListener( 'mouseenter', () => {\r\n\t\tconst target = item.dataset.menu;\r\n\r\n\t\tsubmenu.classList.add( 'visible' );\r\n\t\theaderBottom.classList.add( 'scrolled' );\r\n\t\tlogo.classList.add( 'scrolled' );\r\n\t\tdocument.body.style.overflow = 'hidden';\r\n\r\n\t\tnavItems.forEach( nav => nav.classList.add( 'scrolled' ) );\r\n\t\tnavLinks.forEach( link => link.classList.add( 'scrolled' ) );\r\n\r\n\t\tsubmenuContents.forEach( content => {\r\n\t\t\tif (content.dataset.content === target) {\r\n\t\t\t\tcontent.classList.add( 'active' );\r\n\t\t\t} else {\r\n\t\t\t\tcontent.classList.remove( 'active' );\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\t// Знімаємо active з усіх .submenu-toggle і path\r\n\t\tdocument.querySelectorAll( '.submenu-toggle' ).forEach( toggle => {\r\n\t\t\ttoggle.classList.remove( 'active' );\r\n\t\t\tconst pathEl = toggle.querySelector( 'svg path' );\r\n\t\t\tif (pathEl) pathEl.classList.remove( 'active' );\r\n\t\t} );\r\n\r\n\t\t// Додаємо active до .submenu-toggle і path у поточному item\r\n\t\tconst toggle = item.parentElement.querySelector( '.submenu-toggle' );\r\n\t\tif (toggle) {\r\n\t\t\ttoggle.classList.add( 'active' );\r\n\t\t\tconst pathEl = toggle.querySelector( 'svg path' );\r\n\t\t\tif (pathEl) pathEl.classList.add( 'active' );\r\n\t\t}\r\n\t} );\r\n} );\r\n\r\ndocument.querySelector( '.header' ).addEventListener( 'mouseleave', () => {\r\n\tsubmenu.classList.remove( 'visible' );\r\n\tdocument.body.style.overflow = '';\r\n\r\n\t// Знімаємо active з усіх .submenu-toggle і path\r\n\tdocument.querySelectorAll( '.submenu-toggle' ).forEach( toggle => {\r\n\t\ttoggle.classList.remove( 'active' );\r\n\t\tconst pathEl = toggle.querySelector( 'svg path' );\r\n\t\tif (pathEl) pathEl.classList.remove( 'active' );\r\n\t} );\r\n\r\n\tif (document.body.classList.contains( 'white_header' )) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst styleThreshold = 450;\r\n\r\n\tif (window.scrollY <= styleThreshold) {\r\n\t\theaderBottom.classList.remove( 'scrolled' );\r\n\t\tlogo.classList.remove( 'scrolled' );\r\n\t\tnavItems.forEach( nav => nav.classList.remove( 'scrolled' ) );\r\n\t\tnavLinks.forEach( link => link.classList.remove( 'scrolled' ) );\r\n\t}\r\n} );\r\n\r\n\r\n///////підключення бібліотеки селект2////////////////\r\n$( document ).ready( function () {\r\n\t$( '.js-select2' ).select2( {\r\n\t\tminimumResultsForSearch: -1,\r\n\t\twidth: 'style' // дозволяє нам керувати шириною через JS\r\n\t} );\r\n\r\n\tconst wrapper = document.querySelector( '.gift_items__select' );\r\n\tconst button = wrapper ? wrapper.querySelector( '.shop-gift' ) : null;\r\n\r\n\tif (wrapper && button) {\r\n\t\tconst updateWidth = () => {\r\n\t\t\tconst buttonWidth = button.offsetWidth;\r\n\t\t\twrapper.style.width = `${buttonWidth}px`;\r\n\r\n\t\t\tconst select2Container = wrapper.querySelector( '.select2-container' );\r\n\t\t\tif (select2Container) {\r\n\t\t\t\tselect2Container.style.width = `${buttonWidth}px`;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// Викликати один раз при завантаженні\r\n\t\tupdateWidth();\r\n\r\n\t\t// Використовуємо ResizeObserver для автоматичного оновлення\r\n\t\tconst observer = new ResizeObserver( updateWidth );\r\n\t\tobserver.observe( button );\r\n\t}\r\n} );\r\n\r\n//////////////////////select2 block div width/////////////////\r\nwindow.addEventListener( 'load', () => {\r\n\tconst wrapper = document.querySelector( '.gift_items__select' );\r\n\r\n\tif (!wrapper) return;\r\n\r\n\tconst button = wrapper.querySelector( '.shop-now' );\r\n\r\n\tif (button) {\r\n\t\tconst buttonWidth = button.offsetWidth;\r\n\t\twrapper.style.width = `${buttonWidth}px`;\r\n\t}\r\n} );\r\n\r\n\r\n//////////////////////mobile_burger_menu///////////////////////////////////\r\nconst burger = document.getElementById( 'burger' );\r\nconst mobileMenu = document.getElementById( 'mobileMenu' );\r\nconst closeMenu = document.getElementById( 'closeMenu' );\r\nconst overlay = document.getElementById( 'overlay' );\r\n\r\nfunction openMenu() {\r\n\tmobileMenu.classList.add( 'active' );\r\n\toverlay.classList.add( 'active' );\r\n\tburger.classList.add( 'open' );\r\n\tdocument.body.classList.add( 'scroll-lock' );\r\n}\r\n\r\nfunction closeMenuFunc() {\r\n\tmobileMenu.classList.remove( 'active' );\r\n\toverlay.classList.remove( 'active' );\r\n\tburger.classList.remove( 'open' );\r\n\tdocument.body.classList.remove( 'scroll-lock' );\r\n}\r\n\r\nburger.addEventListener( 'click', openMenu );\r\ncloseMenu.addEventListener( 'click', closeMenuFunc );\r\noverlay.addEventListener( 'click', closeMenuFunc );\r\n\r\n\r\n///////////////////////////сабменю для мобільної версіїї///////////////////////////////////////////////////////\r\ndocument.addEventListener( 'DOMContentLoaded', () => {\r\n\tdocument.querySelectorAll( '.submenu-toggle' ).forEach( toggle => {\r\n\t\ttoggle.addEventListener( 'click', () => {\r\n\t\t\tconst currentLi = toggle.closest( 'li' );\r\n\t\t\tconst submenu = currentLi.querySelector( '.mobile-submenu__list' );\r\n\r\n\t\t\t// Закриваємо інші меню\r\n\t\t\tdocument.querySelectorAll( '.mobile-submenu__list.active' ).forEach( activeMenu => {\r\n\t\t\t\tif (activeMenu !== submenu) {\r\n\t\t\t\t\tactiveMenu.style.maxHeight = '0';\r\n\t\t\t\t\tactiveMenu.classList.remove( 'active' );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t\tdocument.querySelectorAll( '.submenu-toggle.active' ).forEach( activeToggle => {\r\n\t\t\t\tif (activeToggle !== toggle) {\r\n\t\t\t\t\tactiveToggle.classList.remove( 'active' );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\r\n\t\t\t// Перемикаємо активність\r\n\t\t\tif (submenu) {\r\n\t\t\t\tif (submenu.classList.contains( 'active' )) {\r\n\t\t\t\t\t// Закриваємо\r\n\t\t\t\t\tsubmenu.style.maxHeight = submenu.scrollHeight + 'px'; // фіксуємо поточну\r\n\t\t\t\t\tsetTimeout( () => submenu.style.maxHeight = '0', 10 ); // потім плавно закриваємо\r\n\t\t\t\t\tsubmenu.classList.remove( 'active' );\r\n\t\t\t\t\ttoggle.classList.remove( 'active' );\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Відкриваємо\r\n\t\t\t\t\tsubmenu.classList.add( 'active' );\r\n\t\t\t\t\ttoggle.classList.add( 'active' );\r\n\t\t\t\t\tsubmenu.style.maxHeight = submenu.scrollHeight + 'px';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} );\r\n\t} );\r\n} );\r\n\r\n\r\n/////////////////////////catalog_main//////////////\r\ndocument.querySelectorAll( '.filter__material' ).forEach( material => {\r\n\tconst title = material.querySelector( '.material_title' );\r\n\tconst menu = material.querySelector( '.material_menu' );\r\n\tconst arrow = material.querySelector( '.material_arrow' );\r\n\tconst h2 = title.querySelector( 'h2' );\r\n\r\n\tfunction toggleMenu( e ) {\r\n\t\te.preventDefault();\r\n\t\tmenu.classList.toggle( 'active' );\r\n\t\tarrow.classList.toggle( 'active' );\r\n\t}\r\n\r\n\t// Вішаємо події тільки на h2 і стрілку\r\n\th2.addEventListener( 'click', toggleMenu );\r\n\tarrow.addEventListener( 'click', toggleMenu );\r\n} );\r\n\r\n\r\n///////////////////////////////////NOuislider//////////////////////\r\ndocument.addEventListener( 'DOMContentLoaded', function () {\r\n\tvar priceBlocks = document.querySelectorAll( '.price-filter' );\r\n\r\n\tpriceBlocks.forEach( function ( block ) {\r\n\t\tvar sliderEl = block.querySelector( '.js-price-slider' );\r\n\t\tif (!sliderEl || typeof noUiSlider === 'undefined') return;\r\n\r\n\t\tvar rangeMin = parseInt( block.dataset.rangeMin, 10 ) || 20;\r\n\t\tvar rangeMax = parseInt( block.dataset.rangeMax, 10 ) || 1500;\r\n\r\n\t\tvar urlParams = new URLSearchParams( window.location.search );\r\n\t\tvar minParam = block.dataset.minParam;\r\n\t\tvar maxParam = block.dataset.maxParam;\r\n\r\n\t\tvar startMin = parseInt( urlParams.get( minParam ), 10 ) || parseInt( block.dataset.startMin, 10 ) || 20;\r\n\t\tvar startMax = parseInt( urlParams.get( maxParam ), 10 ) || parseInt( block.dataset.startMax, 10 ) || 1500;\r\n\r\n\t\tvar lowerEl = block.querySelector( '.js-price-lower' );\r\n\t\tvar upperEl = block.querySelector( '.js-price-upper' );\r\n\r\n\t\tnoUiSlider.create( sliderEl, {\r\n\t\t\tstart: [startMin, startMax],\r\n\t\t\tconnect: true,\r\n\t\t\trange: {min: rangeMin, max: rangeMax},\r\n\t\t\tstep: 1\r\n\t\t} );\r\n\r\n\t\tif (lowerEl) lowerEl.textContent = startMin;\r\n\t\tif (upperEl) upperEl.textContent = startMax;\r\n\r\n\t\t// Оновлюємо data-* на контейнері (щоб кнопка могла зчитати)\r\n\t\tblock.dataset.currentMin = String( startMin );\r\n\t\tblock.dataset.currentMax = String( startMax );\r\n\r\n\t\tsliderEl.noUiSlider.on( 'update', function ( values ) {\r\n\t\t\tvar minVal = Math.round( values[0] );\r\n\t\t\tvar maxVal = Math.round( values[1] );\r\n\r\n\t\t\tif (lowerEl) lowerEl.textContent = minVal;\r\n\t\t\tif (upperEl) upperEl.textContent = maxVal;\r\n\r\n\t\t\tblock.dataset.currentMin = String( minVal );\r\n\t\t\tblock.dataset.currentMax = String( maxVal );\r\n\t\t} );\r\n\t} );\r\n} );\r\n\r\n\r\n////////////////фільтри анімація//////////////////////////////////////////////////\r\ndocument.addEventListener( 'DOMContentLoaded', () => {\r\n\tconst filters = document.querySelector( '.filters_items' );\r\n\tconst itemsBlock = document.querySelector( '.items_block' );\r\n\tconst wrapper = document.querySelector( '.filters_wrapper' );\r\n\r\n\tif (!filters || !itemsBlock || !wrapper) return;\r\n\r\n\tconst stickyOffset = window.innerWidth < 768 ? 40 : 141;\r\n\tconst  stopOffset = window.innerWidth < 768 ? 40 : 190;\r\n\tconst hysteresis = 10; // буферна зона, щоб уникнути дьоргання\r\n\r\n\tlet isStuck = false;\r\n\tlet isAtBottom = false;\r\n\r\n\tlet lastScrollY = window.scrollY;\r\n\r\n\twindow.addEventListener( 'scroll', () => {\r\n\t\tconst currentScrollY = window.scrollY;\r\n\t\tconst deltaY = Math.abs( currentScrollY - lastScrollY );\r\n\r\n\t\t// Ігноруємо дрібні прокручування менше hysteresis\r\n\t\tif (deltaY < hysteresis) return;\r\n\r\n\t\tlastScrollY = currentScrollY;\r\n\r\n\t\tconst containerTop = wrapper.getBoundingClientRect().top;\r\n\t\tconst itemsBottom = itemsBlock.getBoundingClientRect().bottom;\r\n\t\tconst filtersHeight = filters.offsetHeight;\r\n\r\n\t\t// Зупинка знизу\r\n\t\tif (!isAtBottom && itemsBottom <= filtersHeight + stopOffset) {\r\n\t\t\tisAtBottom = true;\r\n\t\t\tisStuck = false;\r\n\t\t\tfilters.style.position = 'absolute';\r\n\t\t\tfilters.style.top = 'auto';\r\n\t\t\tfilters.style.bottom = '60px';\r\n\t\t\tfilters.classList.remove( 'filters-sticky' );\r\n\t\t\tfilters.classList.add( 'filters-bottom' );\r\n\t\t}\r\n\r\n\t\t// Фіксація вгорі\r\n\t\telse if (!isStuck && containerTop <= stickyOffset && itemsBottom > filtersHeight + stopOffset + hysteresis) {\r\n\t\t\tisStuck = true;\r\n\t\t\tisAtBottom = false;\r\n\t\t\tfilters.style.position = 'fixed';\r\n\t\t\tfilters.style.top = `${stickyOffset}px`;\r\n\t\t\tfilters.style.bottom = 'auto';\r\n\t\t\tfilters.classList.add( 'filters-sticky' );\r\n\t\t\tfilters.classList.remove( 'filters-bottom' );\r\n\t\t}\r\n\r\n\t\t// Повернення в звичайний стан\r\n\t\telse if (containerTop > stickyOffset + hysteresis) {\r\n\t\t\tisStuck = false;\r\n\t\t\tisAtBottom = false;\r\n\t\t\tfilters.style.position = 'static';\r\n\t\t\tfilters.style.top = '';\r\n\t\t\tfilters.style.bottom = '';\r\n\t\t\tfilters.classList.remove( 'filters-sticky', 'filters-bottom' );\r\n\t\t}\r\n\t} );\r\n} );\r\n\r\n\r\n//////////фільтри моб анімація виїзду ////////////////////////////////\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n\tconst filterWrapper = document.querySelector('.filters_wrapper');\r\n\tconst openBtn = document.getElementById('open-filters'); // кнопка відкриття\r\n\tconst closeBtn = document.querySelector('.filter-close'); // твоя кнопка закриття\r\n\r\n\tif (openBtn && filterWrapper && closeBtn) {\r\n\t\topenBtn.addEventListener('click', (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tfilterWrapper.classList.add('active');\r\n\t\t\tdocument.body.style.overflow = 'hidden'; // блокуєм скрол\r\n\t\t});\r\n\r\n\t\tcloseBtn.addEventListener('click', () => {\r\n\t\t\tfilterWrapper.classList.remove('active');\r\n\t\t\tdocument.body.style.overflow = ''; // повертаєм скрол\r\n\t\t});\r\n\t}\r\n});\r\n\r\n\r\n\r\n\r\n////////////////////////////ajax/////////////////////////////////////////////////\r\n\r\nfunction updateProducts( url ) {\r\n\tconst currentGrid = document.querySelector( '#product-grid' );\r\n\tif (!currentGrid) return;\r\n\r\n\t// Додаємо клас fade-out до всіх існуючих товарів\r\n\tconst cards = currentGrid.querySelectorAll( '.card' );\r\n\tcards.forEach( card => card.classList.add( 'fade-out' ) );\r\n\r\n\t// Трохи чекаємо на завершення анімації\r\n\tsetTimeout( () => {\r\n\t\tfetch( url )\r\n\t\t\t.then( res => res.text() )\r\n\t\t\t.then( html => {\r\n\t\t\t\tconst parser = new DOMParser();\r\n\t\t\t\tconst doc = parser.parseFromString( html, 'text/html' );\r\n\r\n\t\t\t\t// Беремо новий grid\r\n\t\t\t\tconst newGrid = doc.querySelector( '#product-grid' );\r\n\r\n\t\t\t\tif (newGrid) {\r\n\t\t\t\t\tcurrentGrid.innerHTML = newGrid.innerHTML;\r\n\r\n\t\t\t\t\t// Додаємо клас плавної появи\r\n\t\t\t\t\tconst newCards = currentGrid.querySelectorAll( '.card' );\r\n\t\t\t\t\tnewCards.forEach( card => {\r\n\t\t\t\t\t\tcard.style.opacity = 0;\r\n\t\t\t\t\t\tcard.style.transform = 'translateY(20px)';\r\n\t\t\t\t\t\tsetTimeout( () => {\r\n\t\t\t\t\t\t\tcard.style.transition = 'opacity 0.4s ease, transform 0.4s ease';\r\n\t\t\t\t\t\t\tcard.style.opacity = 1;\r\n\t\t\t\t\t\t\tcard.style.transform = 'translateY(0)';\r\n\t\t\t\t\t\t}, 50 );\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t// Оновлюємо URL та пагінацію\r\n\t\t\t\t\twindow.history.pushState( {}, '', url );\r\n\t\t\t\t\tattachPaginationListeners();\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t}, 200 ); // час fade-out\r\n}\r\n\r\nfunction attachPaginationListeners() {\r\n\tdocument.querySelectorAll( '.pagination a.page-btn' ).forEach( a => {\r\n\t\ta.addEventListener( 'click', function ( e ) {\r\n\t\t\te.preventDefault();\r\n\t\t\tupdateProducts( this.href );\r\n\t\t} );\r\n\t} );\r\n}\r\n\r\n// Ініціалізація\r\ndocument.addEventListener( 'DOMContentLoaded', () => {\r\n\tattachPaginationListeners();\r\n} );\r\n\r\n\r\n//////////////////////////дескріпшин продукту////////////////////////\r\nconst tabs = document.querySelectorAll( '.tab' );\r\nconst contents = document.querySelectorAll( '.tab-content' );\r\n\r\ntabs.forEach( tab => {\r\n\ttab.addEventListener( 'click', () => {\r\n\t\ttabs.forEach( t => t.classList.remove( 'active' ) );\r\n\t\ttab.classList.add( 'active' );\r\n\r\n\t\tcontents.forEach( c => c.classList.remove( 'active' ) );\r\n\t\tdocument.getElementById( tab.dataset.tab ).classList.add( 'active' );\r\n\t} );\r\n} );\r\n\r\n\r\n/////////////////////////обираємо потрібнний варіант товару в продукті/////////////////////////////////////////\r\ndocument.addEventListener('DOMContentLoaded', function () {\r\n\t// Всі форми продуктів на сторінці\r\n\tconst cartForms = document.querySelectorAll('form[id^=\"product-form-\"]');\r\n\r\n\tcartForms.forEach(form => {\r\n\t\t// шукаємо правильний select всередині форми\r\n\t\tconst variantSelect = form.querySelector('select[id^=\"variant-select\"]');\r\n\t\tconst priceEl = form.closest('.product_details').querySelector('.product_details__price');\r\n\t\tconst optionWrappers = form.closest('.product_details').querySelectorAll('.product_details__filters');\r\n\r\n\t\t// додаємо слухачі на кнопки та select\r\n\t\toptionWrappers.forEach(wrapper => {\r\n\t\t\tconst buttons = wrapper.querySelectorAll('.button_standart.ft');\r\n\t\t\tconst selectEl = wrapper.querySelector('select.gift-select');\r\n\r\n\t\t\t// Кнопки\r\n\t\t\tif (buttons.length) {\r\n\t\t\t\tbuttons.forEach(button => {\r\n\t\t\t\t\tbutton.addEventListener('click', function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tbuttons.forEach(btn => btn.classList.remove('active'));\r\n\t\t\t\t\t\tthis.classList.add('active');\r\n\r\n\t\t\t\t\t\tif (selectEl) {\r\n\t\t\t\t\t\t\tselectEl.value = this.dataset.value;\r\n\t\t\t\t\t\t\tselectEl.dispatchEvent(new Event('change'));\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tupdateVariant();\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Select\r\n\t\t\tif (selectEl) {\r\n\t\t\t\tselectEl.addEventListener('change', function() {\r\n\t\t\t\t\tif (buttons.length) {\r\n\t\t\t\t\t\tbuttons.forEach(btn => {\r\n\t\t\t\t\t\t\tbtn.classList.toggle('active', btn.dataset.value === this.value);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tupdateVariant();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tfunction updateVariant() {\r\n\t\t\tlet selectedOptions = [];\r\n\r\n\t\t\t// Формуємо масив вибраних опцій\r\n\t\t\toptionWrappers.forEach(wrapper => {\r\n\t\t\t\tconst index = wrapper.dataset.optionIndex;\r\n\t\t\t\tconst activeBtn = wrapper.querySelector('.button_standart.ft.active');\r\n\t\t\t\tconst selectEl = wrapper.querySelector('select.gift-select');\r\n\r\n\t\t\t\tif (activeBtn) {\r\n\t\t\t\t\tselectedOptions[index] = activeBtn.dataset.value;\r\n\t\t\t\t} else if (selectEl) {\r\n\t\t\t\t\tselectedOptions[index] = selectEl.value;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// якщо нічого не вибрано, беремо перший варіант\r\n\t\t\t\t\tconst firstOption = wrapper.querySelector('.button_standart.ft, select.gift-select option');\r\n\t\t\t\t\tselectedOptions[index] = firstOption ? firstOption.dataset.value || firstOption.value : '';\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// шукаємо варіант по JSON\r\n\t\t\tlet matchedVariant = Array.from(variantSelect.options).find(option => {\r\n\t\t\t\tconst variantOptions = JSON.parse(option.dataset.options);\r\n\t\t\t\treturn variantOptions.every((opt, i) => opt === selectedOptions[i]);\r\n\t\t\t});\r\n\r\n\t\t\tif (matchedVariant) {\r\n\t\t\t\t// Оновлюємо select\r\n\t\t\t\tvariantSelect.value = matchedVariant.value;\r\n\t\t\t\tvariantSelect.dispatchEvent(new Event('change'));\r\n\r\n\t\t\t\t// Оновлюємо ціну\r\n\t\t\t\tif (priceEl) {\r\n\t\t\t\t\tpriceEl.textContent = matchedVariant.dataset.price;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Оновлюємо картинку\r\n\t\t\t\tconst productContainer = form.closest('.product_details').parentElement;\r\n\t\t\t\tconst mainImage = productContainer.querySelector('#mainImage');\r\n\t\t\t\tconst mainLink = productContainer.querySelector('a[data-fancybox=\"gallery\"]');\r\n\r\n\t\t\t\tif (mainImage && matchedVariant.dataset.image) {\r\n\t\t\t\t\tmainImage.src = matchedVariant.dataset.image;\r\n\t\t\t\t\tif (mainLink) {\r\n\t\t\t\t\t\tmainLink.href = matchedVariant.dataset.image;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Змінюємо URL\r\n\t\t\t\tconst newUrl = `${window.location.pathname}?variant=${matchedVariant.value}`;\r\n\t\t\t\twindow.history.replaceState(null, '', newUrl);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Викликаємо при завантаженні\r\n\t\tupdateVariant();\r\n\t});\r\n});\r\n\r\n\r\n////////////////////////лічильник продуктів////////////////////////////////////////\r\ndocument.querySelectorAll('.product_details').forEach(product => {\r\n\tconst qtyControl = product.querySelector('.quantity-control');\r\n\tconst qtyValue = qtyControl.querySelector('.qty-value');\r\n\tconst form = product.querySelector('form[id^=\"product-form-\"]'); // форма цього продукту\r\n\tconst qtyInput = form.querySelector('input[name=\"quantity\"]'); // hidden всередині форми\r\n\tconst [minusBtn, plusBtn] = qtyControl.querySelectorAll('.qty-btn');\r\n\r\n\tminusBtn.addEventListener('click', () => {\r\n\t\tlet current = parseInt(qtyValue.textContent, 10);\r\n\t\tif (current > 1) current--;\r\n\t\tqtyValue.textContent = current;\r\n\t\tqtyInput.value = current;\r\n\t});\r\n\r\n\tplusBtn.addEventListener('click', () => {\r\n\t\tlet current = parseInt(qtyValue.textContent, 10);\r\n\t\tcurrent++;\r\n\t\tqtyValue.textContent = current;\r\n\t\tqtyInput.value = current;\r\n\t});\r\n});\r\n\r\n\r\n//////////////////////////////лічильник в кошику///////////////////////\r\nfunction setupCartQtyButtons() {\r\n\tconst qtyButtons = document.querySelectorAll('.quantity-control.cart .qty-btn');\r\n\r\n\tqtyButtons.forEach(btn => {\r\n\t\tbtn.addEventListener('click', async () => {\r\n\t\t\tconst key = btn.dataset.key;\r\n\t\t\tconst action = btn.dataset.action;\r\n\t\t\tconst qtyEl = btn.parentElement.querySelector('.qty-value');\r\n\t\t\tlet currentQty = parseInt(qtyEl.textContent, 10);\r\n\r\n\t\t\tlet newQty = action === 'plus' ? currentQty + 1 : currentQty - 1;\r\n\t\t\tif (newQty < 1) newQty = 1;\r\n\r\n\t\t\tconst formData = new FormData();\r\n\t\t\tformData.append('quantity', newQty);\r\n\t\t\tformData.append('id', key);\r\n\r\n\t\t\tawait fetch('/cart/change.js', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tbody: formData\r\n\t\t\t});\r\n\r\n\t\t\t// Оновлюємо корзину\r\n\t\t\tconst cart = await fetch('/cart.js').then(res => res.json());\r\n\t\t\trenderCart(cart);\r\n\t\t});\r\n\t});\r\n}\r\n\r\n\r\n\r\n/////////////////button add to cart//////////////////\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n\tconst cartForms = document.querySelectorAll('form[id^=\"product-form-\"]');\r\n\r\n\tcartForms.forEach(form => {\r\n\t\tform.addEventListener('submit', async e => {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tconst variantSelect = form.querySelector('select[name=\"id\"]'); // name=\"id\" завжди правильний\r\n\t\t\tconst qtyInput = form.querySelector('input.qty-input');       // інпут саме всередині цієї форми\r\n\r\n\r\n\t\t\tconst formData = new FormData();\r\n\t\t\tformData.append('id', variantSelect.value);\r\n\t\t\tformData.append('quantity', qtyInput.value);\r\n\r\n\t\t\t// додаємо товар у кошик\r\n\t\t\tawait fetch('/cart/add.js', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tbody: formData\r\n\t\t\t});\r\n\r\n\t\t\t// отримуємо оновлений cart\r\n\t\t\tconst cart = await fetch('/cart.js').then(res => res.json());\r\n\r\n\t\t\t// перемальовуємо корзину\r\n\t\t\trenderCart(cart);\r\n\r\n\t\t\t// відкриваємо sidebar\r\n\t\t\tdocument.getElementById('cartSidebar').classList.add('active');\r\n\t\t\tdocument.getElementById('cartOverlay').classList.add('active');\r\n\t\t});\r\n\t});\r\n});\r\n\r\n\r\n\r\n\r\n///////////////////корзина////////////////////////////////////////\r\n\r\ndocument.addEventListener('DOMContentLoaded', async () => {\r\n\tconst productForms = document.querySelectorAll('[id^=\"product-form-\"]');\r\n\tconst cartSidebar = document.getElementById('cartSidebar');\r\n\tconst cartOverlay = document.getElementById('cartOverlay');\r\n\r\n\t// 🔹 Стартове завантаження кошика\r\n\tconst cart = await fetch('/cart.js').then(res => res.json());\r\n\trenderCart(cart);\r\n\r\n\t// 🔹 Додавання товару з картки\r\n\tproductForms.forEach(productForm => {\r\n\t\tproductForm.addEventListener('submit', async function(e) {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tconst formData = new FormData(productForm);\r\n\r\n\t\t\tawait fetch('/cart/add.js', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tbody: formData\r\n\t\t\t});\r\n\r\n\t\t\tconst cart = await fetch('/cart.js').then(res => res.json());\r\n\t\t\trenderCart(cart);\r\n\r\n\t\t\tcartSidebar.classList.add('active');\r\n\t\t\tcartOverlay.classList.add('active');\r\n\t\t});\r\n\t});\r\n\r\n\t// === РЕНДЕР КОРЗИНИ (попап + сторінка) ===\r\n\tfunction renderCart(cart) {\r\n\t\tconst cartSidebarItems = document.getElementById('cartItems');\r\n\t\tconst cartPageItems = document.getElementById('cartPageItems');\r\n\r\n\t\t// --- POPUP ---\r\n\t\tif (cartSidebarItems) {\r\n\t\t\tcartSidebarItems.innerHTML = '';\r\n\t\t\tif (cart.items.length === 0) {\r\n\t\t\t\tcartSidebarItems.innerHTML = '<p class=\"cart__fetch\">Cart is empty...</p>';\r\n\t\t\t} else {\r\n\t\t\t\tcart.items.forEach(item => {\r\n\t\t\t\t\tconst card = `\r\n\t\t\t\t\t<div class=\"card\">\r\n\t\t\t\t\t\t<div class=\"card_image cart\">\r\n\t\t\t\t\t\t\t${item.featured_image ? `<a href=\"${item.url}\"><img src=\"${item.featured_image.url}\" alt=\"${item.title}\"></a>` : ''}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"cart-item-info\">\r\n\t\t\t\t\t\t\t<div class=\"cart-item__title\">\r\n\t\t\t\t\t\t\t\t<h4>${item.product_title}</h4>\r\n\t\t\t\t\t\t\t\t<button class=\"remove\" data-key=\"${item.key}\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n  <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M5.28046 19.7849C4.98755 20.0778 4.51264 20.0778 4.21973 19.7849C3.92681 19.492 3.92681 19.0172 4.21973 18.7243L10.9427 12.0023L4.21969 5.28024C3.92677 4.98737 3.92677 4.51253 4.21969 4.21966C4.5126 3.92678 4.98751 3.92678 5.28042 4.21966L12.0034 10.9417L18.7265 4.21965C19.0194 3.92678 19.4943 3.92678 19.7872 4.21965C20.0801 4.51253 20.0801 4.98737 19.7872 5.28024L13.0642 12.0023L19.7872 18.7243C20.0801 19.0172 20.0801 19.492 19.7872 19.7849C19.4943 20.0778 19.0194 20.0778 18.7264 19.7849L12.0035 13.0629L5.28046 19.7849Z\" fill=\"black\"/>\r\n</svg></button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<p class=\"price\">${(item.final_line_price / 100).toFixed(2)} ${cart.currency}</p>\r\n\t\t\t\t\t\t\t${item.options_with_values.map(opt => `\r\n\t\t\t\t\t\t\t\t<div class=\"product_det\">\r\n\t\t\t\t\t\t\t\t\t<p class=\"product__name\">${opt.name}:</p>\r\n\t\t\t\t\t\t\t\t\t<p class=\"product__var\">${opt.value}</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t`).join('')}\r\n\t\t\t\t\t\t\t<div class=\"quantity\">\r\n\t\t\t\t\t\t\t\t<div class=\"quantity-control\">\r\n\t\t\t\t\t\t\t\t\t<button class=\"qty-btn\" data-action=\"minus\" data-key=\"${item.key}\">-</button>\r\n\t\t\t\t\t\t\t\t\t<span class=\"qty-value\">${item.quantity}</span>\r\n\t\t\t\t\t\t\t\t\t<button class=\"qty-btn\" data-action=\"plus\" data-key=\"${item.key}\">+</button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>`;\r\n\t\t\t\t\tcartSidebarItems.insertAdjacentHTML('beforeend', card);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// --- CART PAGE ---\r\n\t\tif (cartPageItems) {\r\n\t\t\tcartPageItems.innerHTML = '';\r\n\t\t\tif (cart.items.length === 0) {\r\n\t\t\t\tcartPageItems.innerHTML = '<p class=\"cart__fetch\">Cart is empty...</p>';\r\n\t\t\t} else {\r\n\t\t\t\tcart.items.forEach(item => {\r\n\t\t\t\t\tconst card = `\r\n\t\t\t\t\t<div class=\"items_card cart\">\r\n\t\t\t\t\t\t<div class=\"card\">\r\n\t\t\t\t\t\t\t<div class=\"card_image cart\">\r\n\t\t\t\t\t\t\t\t${item.featured_image ? `<a href=\"${item.url}\"><img src=\"${item.featured_image.url}\" alt=\"${item.title}\"></a>` : ''}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"cart-item-info\">\r\n\t\t\t\t\t\t\t\t<div class=\"cart-item_wrapper\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"cart-item__title\">\r\n\t\t\t\t\t\t\t\t\t\t<h4>${item.product_title}</h4>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t${item.options_with_values.map(opt => `\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"product_det\">\r\n\t\t\t\t\t\t\t\t\t\t\t<p class=\"product__name\">${opt.name}:</p>\r\n\t\t\t\t\t\t\t\t\t\t\t<p class=\"product__var\">${opt.value}</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t`).join('')}\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"quantity_wrapper\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"quantity\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"quantity-control\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button class=\"qty-btn\" data-action=\"minus\" data-key=\"${item.key}\">-</button>\r\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"qty-value\">${item.quantity}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t<button class=\"qty-btn\" data-action=\"plus\" data-key=\"${item.key}\">+</button>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<button class=\"remove\" data-key=\"${item.key}\"><svg width=\"24\" height=\"25\" viewBox=\"0 0 24 25\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n  <path d=\"M20.25 5.1875H16.3125V4.25C16.3125 3.70299 16.0952 3.17839 15.7084 2.79159C15.3216 2.4048 14.797 2.1875 14.25 2.1875H9.75C9.20299 2.1875 8.67839 2.4048 8.29159 2.79159C7.9048 3.17839 7.6875 3.70299 7.6875 4.25V5.1875H3.75C3.60082 5.1875 3.45774 5.24676 3.35225 5.35225C3.24676 5.45774 3.1875 5.60082 3.1875 5.75C3.1875 5.89918 3.24676 6.04226 3.35225 6.14775C3.45774 6.25324 3.60082 6.3125 3.75 6.3125H4.6875V20C4.6875 20.3481 4.82578 20.6819 5.07192 20.9281C5.31806 21.1742 5.6519 21.3125 6 21.3125H18C18.3481 21.3125 18.6819 21.1742 18.9281 20.9281C19.1742 20.6819 19.3125 20.3481 19.3125 20V6.3125H20.25C20.3992 6.3125 20.5423 6.25324 20.6477 6.14775C20.7532 6.04226 20.8125 5.89918 20.8125 5.75C20.8125 5.60082 20.7532 5.45774 20.6477 5.35225C20.5423 5.24676 20.3992 5.1875 20.25 5.1875ZM8.8125 4.25C8.8125 4.00136 8.91127 3.7629 9.08709 3.58709C9.2629 3.41127 9.50136 3.3125 9.75 3.3125H14.25C14.4986 3.3125 14.7371 3.41127 14.9129 3.58709C15.0887 3.7629 15.1875 4.00136 15.1875 4.25V5.1875H8.8125V4.25ZM18.1875 20C18.1875 20.0497 18.1677 20.0974 18.1326 20.1326C18.0974 20.1677 18.0497 20.1875 18 20.1875H6C5.95027 20.1875 5.90258 20.1677 5.86742 20.1326C5.83225 20.0974 5.8125 20.0497 5.8125 20V6.3125H18.1875V20ZM10.3125 10.25V16.25C10.3125 16.3992 10.2532 16.5423 10.1477 16.6477C10.0423 16.7532 9.89918 16.8125 9.75 16.8125C9.60082 16.8125 9.45774 16.7532 9.35225 16.6477C9.24676 16.5423 9.1875 16.3992 9.1875 16.25V10.25C9.1875 10.1008 9.24676 9.95774 9.35225 9.85225C9.45774 9.74676 9.60082 9.6875 9.75 9.6875C9.89918 9.6875 10.0423 9.74676 10.1477 9.85225C10.2532 9.95774 10.3125 10.1008 10.3125 10.25ZM14.8125 10.25V16.25C14.8125 16.3992 14.7532 16.5423 14.6477 16.6477C14.5423 16.7532 14.3992 16.8125 14.25 16.8125C14.1008 16.8125 13.9577 16.7532 13.8523 16.6477C13.7468 16.5423 13.6875 16.3992 13.6875 16.25V10.25C13.6875 10.1008 13.7468 9.95774 13.8523 9.85225C13.9577 9.74676 14.1008 9.6875 14.25 9.6875C14.3992 9.6875 14.5423 9.74676 14.6477 9.85225C14.7532 9.95774 14.8125 10.1008 14.8125 10.25Z\" fill=\"#D72C0D\"/>\r\n</svg></button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"price_wrapper\">\r\n\t\t\t\t\t\t\t\t\t<p class=\"price\">${(item.final_line_price / 100).toFixed(2)} ${cart.currency}</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>`;\r\n\t\t\t\t\tcartPageItems.insertAdjacentHTML('beforeend', card);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tcartPageItems.insertAdjacentHTML('beforeend', `\r\n\t\t\t\t\t<div class=\"btn_continue\">\r\n\t\t\t\t\t\t<a href=\"/collections/all\">Continue shopping</a>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t`);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// --- SUBTOTAL ---\r\n\t\tconst subtotalEls = document.querySelectorAll('.subtotal__price');\r\n\t\tsubtotalEls.forEach(el => {\r\n\t\t\tel.textContent = (cart.total_price / 100).toFixed(2) + ' ' + cart.currency;\r\n\t\t});\r\n\r\n\t\t// --- COUNTERS ---\r\n\t\tconst cartCounter = document.getElementById('cart_count');\r\n\t\tconst cartCounterheader = document.getElementById('cartBtn');\r\n\t\tif (cartCounter) cartCounter.textContent = `Cart (${cart.item_count})`;\r\n\t\tif (cartCounterheader) cartCounterheader.textContent = `Cart (${cart.item_count})`;\r\n\r\n\t\t// --- ACTIONS ---\r\n\t\tsetupCartQtyButtons();\r\n\t\tsetupRemoveButtons();\r\n\t}\r\n\r\n\t// === Оновлення кількості ===\r\n\tfunction setupCartQtyButtons() {\r\n\t\tconst qtyButtons = document.querySelectorAll('.qty-btn');\r\n\t\tqtyButtons.forEach(btn => {\r\n\t\t\tbtn.onclick = async () => {\r\n\t\t\t\tconst key = btn.dataset.key;\r\n\t\t\t\tconst action = btn.dataset.action;\r\n\t\t\t\tconst qtyEl = btn.parentElement.querySelector('.qty-value');\r\n\t\t\t\tlet currentQty = parseInt(qtyEl.textContent, 10);\r\n\r\n\t\t\t\tlet newQty = action === 'plus' ? currentQty + 1 : currentQty - 1;\r\n\t\t\t\tif (newQty < 1) newQty = 1;\r\n\r\n\t\t\t\tconst cart = await updateCartQuantity(key, newQty);\r\n\t\t\t\trenderCart(cart);\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\r\n\t// === Видалення товару ===\r\n\tfunction setupRemoveButtons() {\r\n\t\tconst removeButtons = document.querySelectorAll('.remove');\r\n\t\tremoveButtons.forEach(btn => {\r\n\t\t\tbtn.onclick = async () => {\r\n\t\t\t\tconst key = btn.dataset.key;\r\n\t\t\t\tconst cart = await updateCartQuantity(key, 0);\r\n\t\t\t\trenderCart(cart);\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\r\n\t// === API update ===\r\n\tasync function updateCartQuantity(key, quantity) {\r\n\t\tconst res = await fetch('/cart/change.js', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\theaders: { 'Content-Type': 'application/json' },\r\n\t\t\tbody: JSON.stringify({ id: key, quantity })\r\n\t\t});\r\n\t\treturn await res.json();\r\n\t}\r\n});\r\n\r\n\r\n////////fetch///////\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n\tconst clearBtn = document.querySelector('.button_standart.fetch');\r\n\r\n\tif (clearBtn) {\r\n\t\tclearBtn.addEventListener('click', async () => {\r\n\t\t\t// очищаємо корзину\r\n\t\t\tawait fetch('/cart/clear.js', { method: 'POST' });\r\n\r\n\t\t\t// отримуємо оновлений cart\r\n\t\t\tconst cart = await fetch('/cart.js').then(res => res.json());\r\n\r\n\t\t\t// перемальовуємо все\r\n\t\t\tupdateCartUI(cart);\r\n\t\t});\r\n\t}\r\n});\r\n\r\n/**\r\n * Оновлює UI корзини всюди (попап + сторінка)\r\n */\r\nfunction updateCartUI(cart) {\r\n\t// 🔹 лічильники\r\n\tconst cartCounter = document.getElementById('cart_count');\r\n\tconst cartCounterHeader = document.getElementById('cartBtn');\r\n\tif (cartCounter) {\r\n\t\tcartCounter.textContent = `Cart (${cart.item_count})`;\r\n\t}\r\n\tif (cartCounterHeader) {\r\n\t\tcartCounterHeader.textContent = `Cart (${cart.item_count})`;\r\n\t}\r\n\r\n\t// 🔹 попап\r\n\tconst popupCartItems = document.getElementById('cartItems');\r\n\tif (popupCartItems) {\r\n\t\tpopupCartItems.innerHTML = '';\r\n\r\n\t\tif (cart.items.length === 0) {\r\n\t\t\tpopupCartItems.innerHTML = '<p class=\"cart__fetch\">Cart is empty...</p>';\r\n\t\t} else {\r\n\t\t\tcart.items.forEach(item => {\r\n\t\t\t\tconst card = `\r\n\t\t\t\t\t<div class=\"card\">\r\n\t\t\t\t\t\t<div class=\"cart-item-info\">\r\n\t\t\t\t\t\t\t<h4>${item.product_title}</h4>\r\n\t\t\t\t\t\t\t<p>${item.quantity} x ${(item.final_line_price / 100).toFixed(2)} ${cart.currency}</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t`;\r\n\t\t\t\tpopupCartItems.insertAdjacentHTML('beforeend', card);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst subtotal = document.querySelector('.subtotal__price');\r\n\t\tif (subtotal) {\r\n\t\t\tsubtotal.textContent = (cart.total_price / 100).toFixed(2) + ' ' + cart.currency;\r\n\t\t}\r\n\t}\r\n\r\n\t// 🔹 сторінка корзини\r\n\tconst pageCartItems = document.getElementById('pageCartItems');\r\n\tif (pageCartItems) {\r\n\t\tpageCartItems.innerHTML = '';\r\n\r\n\t\tif (cart.items.length === 0) {\r\n\t\t\tpageCartItems.innerHTML = '<p>Your cart is empty.</p>';\r\n\t\t} else {\r\n\t\t\tcart.items.forEach(item => {\r\n\t\t\t\tconst row = `\r\n\t\t\t\t\t<div class=\"cart-row\">\r\n\t\t\t\t\t\t<span>${item.product_title}</span>\r\n\t\t\t\t\t\t<span>${item.quantity}</span>\r\n\t\t\t\t\t\t<span>${(item.final_line_price / 100).toFixed(2)} ${cart.currency}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t`;\r\n\t\t\t\tpageCartItems.insertAdjacentHTML('beforeend', row);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n\r\n//////////чекаут кнопк//////////\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n\tconst checkoutContainer = document.getElementById('checkout');\r\n\r\n\tif (checkoutContainer) {\r\n\t\tconst checkoutBtn = checkoutContainer.querySelector('button');\r\n\t\tif (checkoutBtn) {\r\n\t\t\tcheckoutBtn.addEventListener('click', () => {\r\n\t\t\t\t// Переходимо на сторінку оформлення замовлення\r\n\t\t\t\twindow.location.href = '/checkout';\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\n\r\n/////////////////////////////buy now button///////////////////////\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n\tconst buyNowBtn = document.querySelector('.button_standart.buy');\r\n\r\n\tif (buyNowBtn) {\r\n\t\tbuyNowBtn.addEventListener('click', async (e) => {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\t// шукаємо форму Add to Cart (вона завжди є поруч)\r\n\t\t\tconst productDetails = buyNowBtn.closest('.product_details');\r\n\t\t\tconst addToCartForm = productDetails.querySelector('form[id^=\"product-form-\"]');\r\n\r\n\t\t\tconst variantSelect = addToCartForm.querySelector('select[name=\"id\"]');\r\n\t\t\tconst qtyInput = addToCartForm.querySelector('input[name=\"quantity\"]');\r\n\r\n\t\t\tconst variantId = variantSelect.value;\r\n\t\t\tconst qty = qtyInput.value;\r\n\r\n\t\t\tif (!variantId) {\r\n\t\t\t\talert('Виберіть варіант товару');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// додаємо товар у корзину\r\n\t\t\tconst formData = new FormData();\r\n\t\t\tformData.append('id', variantId);\r\n\t\t\tformData.append('quantity', qty);\r\n\r\n\t\t\tawait fetch('/cart/add.js', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tbody: formData\r\n\t\t\t});\r\n\r\n\t\t\t// ведемо одразу в checkout\r\n\t\t\twindow.location.href = '/checkout';\r\n\t\t});\r\n\t}\r\n});\r\n\r\n\r\n\r\n/////////////////////////////відкриття попап cart///////////////////////////////\r\nconst cartBtn = document.getElementById('cartBtn');\r\nconst cartImg = document.getElementById('cartImg');\r\nconst cartImgMob = document.getElementById('cartImgMob');\r\nconst cartSidebar = document.getElementById('cartSidebar');\r\nconst cartClose = document.getElementById('cartClose');\r\nconst cartOverlay = document.getElementById('cartOverlay');\r\n\r\nfunction openCart() {\r\n\tcartSidebar.classList.add('active');\r\n\tcartOverlay.classList.add('active');\r\n\tdocument.body.classList.add('scroll-lock');\r\n}\r\n\r\nfunction closeCartFunc() {\r\n\tcartSidebar.classList.remove('active');\r\n\tcartOverlay.classList.remove('active');\r\n\tdocument.body.classList.remove('scroll-lock');\r\n}\r\n\r\ncartBtn.addEventListener('click', openCart);\r\ncartImg.addEventListener('click', openCart);\r\ncartImgMob.addEventListener('click', openCart);\r\ncartClose.addEventListener('click', closeCartFunc);\r\ncartOverlay.addEventListener('click', closeCartFunc);\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]}